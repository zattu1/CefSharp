<Window x:Class="CefSharp.fastBOT.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:cef="clr-namespace:CefSharp.Wpf;assembly=CefSharp.Wpf"
        Title="fastBOT - チケット自動購入ツール" 
        Height="854" Width="1320"
        WindowStartupLocation="CenterScreen"
        Icon="Resources/fastBOT.ico">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="280"/>
        </Grid.ColumnDefinitions>

        <!-- メインブラウザエリア -->
        <Grid Grid.Column="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- ブラウザコントロールバー -->
            <Grid Grid.Row="0" Background="LightGray" Margin="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <Button x:Name="PrevButton" Grid.Column="0" Content="◀" Width="40" FontSize="18" 
                        ToolTip="戻る" Click="PrevButton_Click" Margin="2"/>
                <Button x:Name="NextButton" Grid.Column="1" Content="▶" Width="40" FontSize="18" 
                        ToolTip="進む" Click="NextButton_Click" Margin="2"/>
                <Button x:Name="ReloadButton" Grid.Column="2" Content="⟳" Width="40" FontSize="18" 
                        ToolTip="再読込" Click="ReloadButton_Click" Margin="2"/>
                <Button x:Name="TopButton" Grid.Column="3" Content="■" Width="40" FontSize="18" 
                        ToolTip="トップ画面へ" Click="TopButton_Click" Margin="2"/>

                <!-- URL入力エリア（ブラウザ幅全体を使用） -->
                <Border Grid.Column="4" Background="White" CornerRadius="3" Margin="5,2" BorderBrush="Gray" BorderThickness="1">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Favicon表示エリア -->
                        <Image x:Name="AddressFaviconImage" Grid.Column="0" 
                               Width="16" Height="16" 
                               Margin="6,0,4,0" 
                               VerticalAlignment="Center"/>

                        <!-- URL入力ボックス -->
                        <TextBox x:Name="UrlLineEdit" Grid.Column="1" 
                                 BorderThickness="0" 
                                 Background="Transparent"
                                 VerticalAlignment="Center"
                                 Padding="0,3"
                                 KeyDown="UrlLineEdit_KeyDown"/>
                    </Grid>
                </Border>

                <Button x:Name="GoButton" Grid.Column="5" Content="移動" Click="GoButton_Click" Margin="2"/>
                <Button x:Name="NewTabButton" Grid.Column="6" Content="+" Width="30" FontSize="16" 
                        ToolTip="新しいタブ (Ctrl+T)" Click="CreateNewTabButton_Click" Margin="5,2,2,2"/>
            </Grid>

            <!-- プログレスバー -->
            <ProgressBar x:Name="WebProgressBar" Grid.Row="1" Height="2" 
                         Background="Transparent" Foreground="#da4453"/>

            <!-- タブコントロール -->
            <TabControl x:Name="TabWidget" Grid.Row="2" Margin="2">
                <!-- タブは動的に追加 -->
                <TabControl.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="新しいタブ(_N)" InputGestureText="Ctrl+T" Click="NewTabMenuItem_Click">
                            <MenuItem.Icon>
                                <TextBlock Text="+" FontWeight="Bold"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem Header="タブを閉じる(_C)" InputGestureText="Ctrl+W" Click="CloseTabMenuItem_Click">
                            <MenuItem.Icon>
                                <TextBlock Text="×" FontWeight="Bold"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="他のタブを閉じる(_O)" Click="CloseOtherTabsMenuItem_Click"/>
                        <Separator/>
                        <MenuItem Header="タブを複製(_D)" Click="DuplicateTabMenuItem_Click">
                            <MenuItem.Icon>
                                <TextBlock Text="⧉" FontWeight="Bold"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="新しいウィンドウで開く(_W)" Click="NewWindowMenuItem_Click">
                            <MenuItem.Icon>
                                <TextBlock Text="🗔" FontWeight="Bold"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem Header="タブ復元(_R)" InputGestureText="Ctrl+Shift+T" Click="RestoreLastClosedTabMenuItem_Click" IsEnabled="False">
                            <MenuItem.Icon>
                                <TextBlock Text="↶" FontWeight="Bold"/>
                            </MenuItem.Icon>
                        </MenuItem>
                    </ContextMenu>
                </TabControl.ContextMenu>
            </TabControl>
        </Grid>

        <!-- 右側コントロールパネル -->
        <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <StackPanel Margin="5">

                <!-- プログレスバー -->
                <ProgressBar x:Name="ProgressBar" Maximum="11" Value="0" Height="20" Margin="0,0,0,5"/>

                <!-- ログイン情報 -->
                <GroupBox Header="ログイン情報" Margin="0,5">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="80"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Label Grid.Row="0" Grid.Column="0" Content="ログインID:"/>
                        <TextBox x:Name="LoginEdit" Grid.Row="0" Grid.Column="1"/>

                        <Label Grid.Row="1" Grid.Column="0" Content="パスワード:"/>
                        <PasswordBox x:Name="PasswordEdit" Grid.Row="1" Grid.Column="1"/>

                        <Button x:Name="LoginButton" Grid.Row="2" Grid.Column="1" 
                                Content="ログイン" HorizontalAlignment="Left" Width="80" 
                                Click="LoginButton_Click"/>
                    </Grid>
                </GroupBox>

                <!-- Proxy設定 -->
                <GroupBox Header="Proxy設定" Margin="0,5">
                    <StackPanel>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Label Grid.Row="0" Grid.Column="0" Content="Proxy:"/>
                            <TextBox x:Name="ProxyLineEdit" Grid.Row="0" Grid.Column="1" 
                                     Text="127.0.0.1:8080" TextChanged="ProxyLineEdit_TextChanged"/>

                            <CheckBox x:Name="ProxyRotationCheckBox" Grid.Row="1" Grid.ColumnSpan="2" 
                                      Content="Proxyローテーション" Margin="0,3" 
                                      Checked="ProxyRotationCheckBox_Checked" 
                                      Unchecked="ProxyRotationCheckBox_Unchecked"/>

                            <StackPanel Grid.Row="2" Grid.ColumnSpan="2" Orientation="Horizontal">
                                <RadioButton x:Name="PerRequestRadioButton" Content="毎回" 
                                             IsChecked="True" Margin="5,0"/>
                                <RadioButton x:Name="EverySecondRadioButton" Content="秒毎" 
                                             Margin="5,0"/>
                                <TextBox x:Name="ProxyEverySecondLineEdit" Width="60" 
                                         Text="30" Margin="5,0"/>
                                <Label Content="秒"/>
                            </StackPanel>
                        </Grid>

                        <Button x:Name="ApplyProxyButton" Content="Proxy適用" 
                                Click="ApplyProxyButton_Click" Margin="0,5"/>
                    </StackPanel>
                </GroupBox>

                <!-- 購入者情報 -->
                <GroupBox Header="購入者情報" Margin="0,5">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="60"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Label Grid.Row="0" Grid.Column="0" Content="姓名:"/>
                        <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal">
                            <TextBox x:Name="LastNameLineEdit" Width="70"/>
                            <TextBox x:Name="FirstNameLineEdit" Width="70" Margin="5,0,0,0"/>
                        </StackPanel>

                        <Label Grid.Row="1" Grid.Column="0" Content="カナ:"/>
                        <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal">
                            <TextBox x:Name="LastKanaLineEdit" Width="70"/>
                            <TextBox x:Name="FirstKanaLineEdit" Width="70" Margin="5,0,0,0"/>
                        </StackPanel>

                        <Label Grid.Row="2" Grid.Column="0" Content="TEL:"/>
                        <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal">
                            <TextBox x:Name="Tel1LineEdit" Width="40"/>
                            <Label Content="-"/>
                            <TextBox x:Name="Tel2LineEdit" Width="50"/>
                            <Label Content="-"/>
                            <TextBox x:Name="Tel3LineEdit" Width="50"/>
                        </StackPanel>

                        <Label Grid.Row="3" Grid.Column="0" Content="Email:"/>
                        <TextBox x:Name="EmailLineEdit" Grid.Row="3" Grid.Column="1"/>
                    </Grid>
                </GroupBox>

                <!-- クレジットカード -->
                <GroupBox Header="クレジットカード" Margin="0,5">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="60"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Label Grid.Row="0" Grid.Column="0" Content="番号:"/>
                        <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal">
                            <TextBox x:Name="CardNumberLineEdit" Width="120"/>
                            <Label Content="CVV"/>
                            <TextBox x:Name="CvvLineEdit" Width="50"/>
                        </StackPanel>

                        <Label Grid.Row="1" Grid.Column="0" Content="有効期限:"/>
                        <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal">
                            <ComboBox x:Name="MonthComboBox" Width="50"/>
                            <Label Content="月"/>
                            <ComboBox x:Name="YearComboBox" Width="60"/>
                            <Label Content="年"/>
                        </StackPanel>

                        <Label Grid.Row="2" Grid.Column="0" Content="名義人:"/>
                        <TextBox x:Name="CardNameLineEdit" Grid.Row="2" Grid.Column="1"/>
                    </Grid>
                </GroupBox>

                <!-- 公演情報 -->
                <GroupBox Header="公演情報" Margin="0,5">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Label Content="公演情報"/>
                            <CheckBox x:Name="AllCheckBox" Content="全て選択/解除" 
                                      Margin="20,0,0,0" Click="AllCheckBox_Click"/>
                        </StackPanel>
                        <ListBox x:Name="EventListWidget" Height="120"/>

                        <StackPanel Orientation="Horizontal" Margin="0,5">
                            <Label Content="購入数:"/>
                            <ComboBox x:Name="NumComboBox" Width="60">
                                <ComboBoxItem Content="1"/>
                                <ComboBoxItem Content="2"/>
                            </ComboBox>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <!-- 自動化設定 -->
                <GroupBox Header="自動化設定" Margin="0,5">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Label Content="チェック間隔:"/>
                            <TextBox x:Name="IntervalEdit" Width="60" Text="2000"/>
                            <Label Content="msec"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Margin="0,10">
                            <Button x:Name="StartButton" Content="開始" Width="80" 
                                    Click="StartButton_Click" IsEnabled="False"/>
                            <Button x:Name="StopButton" Content="停止" Width="80" 
                                    Click="StopButton_Click" Margin="5,0"/>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <!-- ステータス表示 -->
                <GroupBox Header="ステータス" Margin="0,5">
                    <StackPanel>
                        <TextBlock x:Name="StatusText" Text="Ready" Margin="0,2"/>
                        <TextBlock x:Name="ProxyStatusText" Text="Proxy: 未設定" Margin="0,2"/>
                        <TextBlock x:Name="RequestContextInfo" Text="Context: Default" Margin="0,2"/>
                    </StackPanel>
                </GroupBox>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>